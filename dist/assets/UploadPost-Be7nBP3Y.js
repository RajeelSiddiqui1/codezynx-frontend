import{f as y,c as j,e as w,H as N,r as x,u as v,j as e,I as r}from"./index-BAzBCm5Y.js";/**
 * @license lucide-react v0.503.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],k=y("loader-circle",P),C=()=>{const t=j(),{mutate:o,isPending:n,error:l}=w({mutationFn:N,onSuccess:()=>{t.invalidateQueries({queryKey:["authUser"]})}});return{isPending:n,error:l,postMutation:o}},I=()=>{const[t,o]=x.useState({title:"",description:"",attachments:null}),[n,l]=x.useState(!1),{isPending:c,postMutation:b}=C(),f=v(),i=d=>{const{name:a,value:s,files:u}=d.target;o(a==="attachments"?{...t,attachments:u[0]}:{...t,[a]:s})},g=d=>{d.preventDefault(),l(!0),setTimeout(()=>{const a=new FormData;a.append("title",t.title),a.append("description",t.description),t.attachments&&a.append("attachments",t.attachments),b(a,{onSuccess:s=>{r.success("Post uploaded successfully!"),s!=null&&s.generatedByAI&&r("Your description was generated by AI ü§ñ",{icon:"ü§ñ",style:{background:"#333",color:"#fff"}}),f("/")},onError:s=>{var p,h;console.error("üß® Full error object:",s);const m=((h=(p=s==null?void 0:s.response)==null?void 0:p.data)==null?void 0:h.error)||(s==null?void 0:s.message)||"Upload failed";m.includes("Information Technology")?r.error("‚ùå Only IT-related posts are allowed!"):r.error(m)}}),l(!1)},5e3)};return e.jsxs("div",{className:"max-w-xl mx-auto p-6 rounded-xl mt-3 border shadow backdrop-blur-md",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Upload Post"}),e.jsxs("form",{onSubmit:g,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-medium",children:"Title"}),e.jsx("input",{type:"text",name:"title",value:t.title,onChange:i,className:"w-full border rounded px-3 py-2 bg-transparent outline-none",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-medium",children:"Description"}),e.jsx("textarea",{name:"description",value:t.description,onChange:i,rows:"4",className:"w-full border rounded px-3 py-2 bg-transparent outline-none resize-none",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-medium",children:"Attachment"}),e.jsx("input",{type:"file",name:"attachments",onChange:i,className:"w-full"})]}),e.jsx("button",{type:"submit",className:`w-full py-2 px-4 rounded transition ${c||n?"bg-gray-600 cursor-not-allowed":"bg-gray-800 hover:bg-gray-700"}`,disabled:c||n,children:c||n?e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(k,{className:"animate-spin w-5 h-5"}),"Generating your description..."]}):"Upload Post"})]})]})};export{I as default};
